/*
 * ExampleTypes.idl
 * 
 * IDL definitions for example data types with basic members
 * Simple types for demonstration and testing purposes
 */

module example_types {
    
    // Maximum string lengths for bounded strings
    const unsigned long MAX_ID_LENGTH = 32;
    const unsigned long MAX_NAME_LENGTH = 64;
    const unsigned long MAX_MESSAGE_LENGTH = 128;
    const unsigned long MAX_VALUE_LENGTH = 128;
    const unsigned long MAX_IMAGE_DATA_SIZE = 1024;
    
    // Basic enumerations
    enum CommandType {
        START = 0,  // drop pre-ambles for better discovery performance, keeping unique across all Enums
        STOP,
        PAUSE,
        RESET,
        SHUTDOWN
    };
    
    enum SystemState {
        INIT,
        RUNNING = 0,  // use type default for common case 
        ERROR,
        RESTARTING,
        SHUTTING_DOWN
    };
    
    enum ButtonState {
        RELEASED = 0,
        PRESSED,
        HELD,
        DOUBLE_CLICK
    };
    
    /**
     * Command - Basic command structure
     */
    struct Command {
        @key string<MAX_ID_LENGTH> command_id;     // Unique command identifier
        string<MAX_ID_LENGTH> destination_id; // Target destination identifier
        CommandType command_type;                   // Type of command
        string<MAX_MESSAGE_LENGTH> message;         // Command message or description
        // unsigned long timestamp_sec;               // Command timestamp - drop in favor of metadata
        unsigned short urgent;                            // Priority value: higher = more urgent
    };
    
    /**
     * Config - Basic configuration structure
     */
    struct Config {
        @key string<MAX_ID_LENGTH> destination_id;      // Configuration identifier
        string<MAX_NAME_LENGTH> parameter_name;    // Parameter name
        string<MAX_VALUE_LENGTH> parameter_value; // Parameter value
        double numeric_value;                       // Numeric parameter value
        boolean enabled;                           // Enable/disable flag
    };
    
    /**
     * Position - Current location reporting structure
     */
    struct Position {
        @key string<MAX_ID_LENGTH> source_id;      // Source identifier
        double latitude;                            // Latitude in degrees
        double longitude;                          // Longitude in degrees
        double altitude;                           // Altitude in meters
        unsigned long timestamp_sec;              // Position timestamp
    };
    
    /**
     * State - Basic state information structure
     */
    struct State {
        @key string<MAX_ID_LENGTH> source_id;      // Source identifier
        SystemState state_value;                    // State enumeration
        string<MAX_MESSAGE_LENGTH> error_message;   // Error message or status description
    };
    
    /**
     * Button - Basic button input structure
     */
    struct Button {
        @key string<MAX_ID_LENGTH> source_id;      // Source identifier
        @key string<MAX_ID_LENGTH> button_id;      // Button identifier
        ButtonState button_state;                   // Current button state
        unsigned long press_count;                 // Total press count
        unsigned long last_press_timestamp_sec;    // Last press time
        double hold_duration_sec;                  // Hold duration for held buttons
    };
    
    /**
     * Image - Basic image data structure
     */
    struct Image {
        @key string<MAX_ID_LENGTH> image_id;       // Image identifier
        unsigned long width;                       // Image width in pixels
        unsigned long height;                      // Image height in pixels
        string<MAX_NAME_LENGTH> format;            // Image format (e.g., "RGB", "JPEG")
        sequence<octet, MAX_IMAGE_DATA_SIZE> data; // Image data bytes
    };

// consider factoring out image width+height as nested structure for reuse

    /**
     * FinalFlatImage - High-performance image structure using @final FlatData
     * @final provides maximum zero-copy performance but requires only fixed-size types
     * Uses numeric format code instead of string, and fixed-size array instead of sequence
     */
    @final
    @transfer_mode(SHMEM_REF)
    @language_binding(FLAT_DATA)
    struct FinalFlatImage {
        @key unsigned long image_id;                   // Numeric image identifier
        unsigned short width;                           // Image width in pixels
        unsigned short height;                          // Image height in pixels
        unsigned byte format;                          // Format code: 0=RGB, 1=RGBA, 2=JPEG, etc.
        octet data[MAX_IMAGE_DATA_SIZE];              // Fixed-size image data array
    };

    
}; // namespace example_types
